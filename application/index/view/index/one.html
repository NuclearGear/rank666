{include file="public/header"}

<!-- Page Container -->
<div class="page-container">
    <!-- Page Sidebar -->
    {include file="public/sidebar"}
    <!-- /Page Sidebar -->

    <!-- Page Content -->
    <div class="page-content">

        <!-- Page Inner -->
        <div class="page-inner">
            <div class="page-title">
                <h3 class="breadcrumb-header">毒—App</h3>
            </div>
            <div class="panel panel-white">
                <div class="panel-body">
                    <div class="row">
                        <div class="form-group col-sm-3" for="exampleInputEmail3">
                            <label class="sr-only">货号</label>
                            <input class="form-control articleNumber" value="575441-602" placeholder="货号">
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-sm-3" for="exampleInputEmail3">
                            <label class="sr-only">统计天数</label>
                            <input class="form-control day" value="7" placeholder="统计天数">
                        </div>
                    </div>
                    <button type="submit" class="btn btn-danger sure-btn">统计</button>
                </div>
            </div>

            <div id="main-wrapper">
                <div class="row">
                    <div class="col-md-12">
                        <div class="panel panel-white">
                            <div class="panel-heading clearfix">
                                <h4 class="panel-title">单品统计-按天数</h4>
                            </div>
                            <div class="panel-body" id="echart_1" style="height: 500px;">

                            </div>
                        </div>
                    </div>
                </div><!-- Row -->
            </div><!-- Main Wrapper -->
        </div><!-- /Page Inner -->
    </div><!-- /Page Content -->
</div><!-- /Page Container -->


{include file="public/footer"}

<script>
    $('.sure-btn').click(function () {
        var myChart = echarts.init(document.getElementById('echart_1'));
        var day = $('.day').val();
        var articleNumber = $('.articleNumber').val();

        $.get("{:url('index/AjaxProductOne')}",{day:day, articleNumber:articleNumber}, function (ret) {
            var echart_option = [];
            for(var i in ret.data){

                var price_arr = [];
                var size_option = {
                    'name': i,
                    'type': 'line',
                    'data':price_arr
                };
                for(var j in ret.data[i]){
                    price_arr.push(ret.data[i][j])
                }
                echart_option.push(size_option)
            }

            option = {
                title: {
                    text: ret.data.name,
                    top:30,
                },
                tooltip: {
                    trigger: 'axis'
                },
                legend: {
                    data:ret.data['sizeName']
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    containLabel: true
                },
                toolbox: {
                    feature: {
                        saveAsImage: {}
                    }
                },
                xAxis: {
                    type: 'category',
                    boundaryGap: false,
                    data: ret.data['time']
                },
                yAxis: {
                    type: 'value'
                },
                series: echart_option
            };
            myChart.setOption(option)
        });
    });
</script>
